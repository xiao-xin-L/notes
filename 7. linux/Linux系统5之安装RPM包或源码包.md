# Linux系统5之安装RPM包或源码包

在Windows系统下安装软件很简单，只要双击后缀为.exe的文件，然后根据提示连续单击“下一步”按钮即可。然而在Linux系统下安装软件就没那么容易了，因为我们不是在图形界面下。所以，你必须学会如何在Linux下安装软件

yum命令，它是Red Hat所特有的安装RPM程序包的工具。使用RPM工具安装某一个程序包时，有可能会因为该程序包依赖另一个程序包而无法安装；而使用yum工具时，就可以连同依赖的程序包一起安装，很方便。在CentOS里使用yum工具是免费的

## 1 RPM 工具

RPM是Red Hat Package Manager的缩写，由Red Hat公司开发。它是以一种数据库记录的方式将我们所需要的套件安装到Linux主机的一套管理程序。也就是说，你的Linux系统中存在着一个关于RPM的数据库，它记录了安装的包以及包与包之间的依赖关系。RPM包是预先在Linux机器上编译并打包的文件，安装非常快捷。但它也有一些缺点，比如安装环境必须与编译时的环境一致或者相当，包与包之间存在着相互依赖的情况，卸载包时需要先把依赖的包卸载。如果依赖的包是系统所必需的，就不能卸载这个包，否则系统会崩溃。



我们可以在网上搜索一些软件的下载地址, 然后只用wget指令, 去从该链接下载一个rpm包

![image-20200307224141601](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200307224141601.png)

### 1.1 wget命令

wget命令用来从指定的URL下载文件。wget非常稳定，它在带宽很窄的情况下和不稳定网络中有很强的适应性，如果是由于网络的原因下载失败，wget会不断的尝试，直到整个文件下载完毕。如果是服务器打断下载过程，它会再次联到服务器上从停止的地方继续下载。这对从那些限定了链接时间的服务器上下载大文件非常有用。

1. 下载并以不同的文件名保存：

   ```zsh
   wget -O test.zip http://www.Linuxcool.com
   ```

2. wget限速下载:

   ```bash
    wget --limit-rate=300k http://www.linuxcool.com/test.zip
   ```

3. 使用wget断点续传：

   ```bash
   wget -c http://www.linuxcool.com/test.zip
   ```

4. 使用wget后台下载：

   ```bash
   wget -b http://www.linuxcool.com/test.zip
   ```

   

### 1.2 安装rpm软件

![image-20200307224554994](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200307224554994.png)

我们现在已经准备好了一个rpm文件, 是vscode的安装包( 注意, 如果你的linux系统没有安装一个桌面环境的话, 在只有一个linux命令行界面的情况下, 安装这种有界面的软件, 没啥意义的 )



安装rpm软件的指令的格式是  rpm [-ivh]  filename

 -i：表示安装。
 -v：表示可视化。
 -h：表示显示安装进度。

另外，在安装RPM包时，常用的附带参数还包括如下几项。
 --force：表示强制安装，即使覆盖属于其他包的文件也要安装。
 --nodeps：表示当要安装的RPM包依赖于其他包时，即使其他包没有安装，也要安装这个包。

![image-20200307225716289](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200307225716289.png)

于是乎我们就需要安装几个依赖包

1.yum install libXScrnSaver*

2.yum install epel-release

3.yum install libappindicator-gtk3

安装完依赖包之后再用rpm 指令来安装这个软件

![image-20200307234046499](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200307234046499.png)

![image-20200307231642477](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200307231642477.png)

## 2 yum工具

yum工具最大的优势在于可以联网去下载所需要的RPM包，然后自动安装。如果要安装的RPM包有依赖关系，yum工具会帮我们依次安装所有相关的RPM包。我们就不需要在自己手动一个个安装依赖包了

### 2.1 yum list

使用yum list 命令，可以列出所有的RPM包资源. 这个显示出来的列表包括了软件的名称, 版本号, 以及软件的类别

![image-20200307234428095](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200307234428095.png)

### 2.2 yum search

搜索RPM包的命令为yum search [相关关键词]

![image-20200308130718263](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200308130718263.png)

### 2.3 安装RPM 包

安装RPM包的命令为yum install [-y] [RPM包名]，如果不加-y选项，则会以与用户交互的方式安装

在这个过程中，它首先会把需要安装的RPM包列出来，如果有依赖关系，也会把所有依赖的包列出来。然后询问用户是否需要安装，输入y则安装，输入n则不安装;  但是如果我们加了-y的选项, 那么就会默认都选择y, 就可以直接省略掉询问用户的那一步

![image-20200308131342904](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200308131342904.png)

### 2.4 卸载 RPM包

卸载RPM包的命令为yum remove [-y] [RPM包名], 卸载和安装一样，也可以直接加上-y选项，从而省略与用户交互的那一步

卸载某个RPM包时一定要看清楚，不要连其他重要的RPM包也一起卸载了，以免影响正常的业务，所以使用yum remove命令卸载包

![image-20200308145505496](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200308145505496.png)

### 2.5 升级RPM 包

升级RPM包的命令为yum update [-y] [RPM包]

![image-20200308145135804](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200308145135804.png)

##  3 安装源码包

在Linux下安装源码包是最常用的. 因为系统自带的包管理器收录的软件版本不一定是最新的, 因此有时候我们需要特定版本的时候就得自己手动去下载对应的包, 并且进行配置

源码包的编译用到了Linux系统里的编译器。常见的源码包一般都是用C语言开发的，因为C语言是Linux上最标准的程序语言。Linux上的C语言编译器称为gcc，利用它可以把C语言编译成可执行的二进制文件。所以，如果你的机器上没有安装gcc，就无法编译源码，你可以使用命令yum install -y gcc来完成安装。

安装源码包通常需要以下3个步骤。
(1) ./configure。这一步可以定制功能，加上相应的选项即可，具体有什么选项可以通过命令./configure --help来查看。这一步会自动检测你的Linux系统与相关的套件是否有编译该源码包时所需要的库，因为一旦缺少某个库，就不能完成编译。只有检测通过后，才会生成Makefile文件。
(2) make。使用这个命令，会根据Makefile文件中预设的参数进行编译，这一步其实就是gcc在工作了。
(3) make install。这一步是安装步骤，用于创建相关软件的存放目录和配置文件。

对于以上这3个步骤，并不是所有的源码包软件都一样，也就是说，源码包的安装并没有标准的安装步骤。这就需要你拿到源码包解压后，进入目录，找到相关的帮助文档（通常，会以INSTALL或者README为文件名）

![image-20200308150253215](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200308150253215.png)

我们以node为例, 自己手动下载12.16的最新版的源码

然后用解压指令进行解压, 再进入解压后的文件夹中, 就可以看到源码目录了

![image-20200308150917804](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200308150917804.png)

我们输入配置选项, 可以看到提示我们缺少python的依赖, 那我们就先把python的依赖先安装好

在配置好python的环境后, 我们可以看到新的警告和提示, 告诉我们缺少了C的编译器

![image-20200308153954523](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200308153954523.png)

所以我们再安装一个C的编译器

```bash
yum install -y gcc
```

然后在执行./configure, 可以看到只剩下一个警告了

![image-20200308154513384](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200308154513384.png)

```bash
sudo yum install gcc-c++
```

继续安装一些依赖环境

截止输入make指令, 再输入make install 即可

不过不是很建议直接安装源码包, 因为需要你的编译环境与该包的环境完全一致,这样才阔以

## 4 配置环境类的软件

有些软件服务商会给我们编译好并且打包好, 我们下载下来之后, 无需再次编译, 但是也无法直接使用

![image-20200308194314735](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200308194314735.png)

我们在/usr/share下创建一个node目录

然后通过wget指令 把文件下载到本地,并进行解压

![image-20200308201021067](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200308201021067.png)



![image-20200308200509082](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200308200509082.png)

大家可以看到这个解压后的文件里面的bin文件夹中, 我们可以直接执行这个node. 

这个与我们用yum 安装好node之后, 直接输入 node指令出来道理相同, 但是现在却无法直接直接输入node, 原因是, 现在系统的环境配置里面, 还没有当前这个文件夹

于是乎 , 我们就得自己来配置一下环境

配置环境变量的文件保存在 /etc/profile的文件里面

![image-20200308212004842](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200308212004842.png)

添加一个环境变量:    /usr/share/node/node-v12.16.1-linux-x64/bin

然后把这个文件重新启用一次

```bash
source /etc/profile
```

![image-20200308212050794](Linux%E7%B3%BB%E7%BB%9F5%E4%B9%8B%E5%AE%89%E8%A3%85RPM%E5%8C%85%E6%88%96%E6%BA%90%E7%A0%81%E5%8C%85.assets/image-20200308212050794.png)

然后我们就可以去使用node了

